syntax = "proto3";

option csharp_namespace = "MediCloud.Application.Common.Protos";

package livestream;

service Livestream {
  rpc StartPullStream (StartPullStreamRequest) returns (StartPullStreamResponse);

  rpc StopPullStream (StopPullStreamRequest) returns (StopPullStreamResponse);

  rpc ListActiveStreams (ListActiveStreamsRequest) returns (ListActiveStreamsResponse);

  rpc GetStreamInfo (GetStreamInfoRequest) returns (GetStreamInfoResponse);

  rpc WatchStreamStatus (WatchStreamStatusRequest) returns (stream WatchStreamStatusResponse);
}

message StartPullStreamRequest {
  string live_id = 1;
  string passphrase = 2;
}

message StartPullStreamResponse {
  string live_id = 1;
  uint32 port = 2;
  string passphrase = 3;
}

message StopPullStreamRequest {
  string live_id = 1;
}

message StopPullStreamResponse {
  bool is_success = 1;
}

message ListActiveStreamsRequest {
}

message ListActiveStreamsResponse {
  repeated string live_ids = 1;
}

message GetStreamInfoRequest {
  string live_id = 1;
}

message GetStreamInfoResponse {
  uint32 port = 1;
  string passphrase = 2;
}

message WatchStreamStatusRequest {
  string live_id = 1;
}

message WatchStreamStatusResponse {
  string live_id = 1;
  bool is_streaming = 2;
}
